## Локализация режимов

Этот раздел описывает, как локализовать тексты режима (подсказки, параметры, описания) с помощью JSON-файлов внутри архива режима.

### Структура файлов

Разместите словари в каталоге `client/localization/` вашего режима:
```
client/localization/
  en.json
  ru.json
  es.json
```
Каждый файл — это объект «ключ → перевод».

Пример `ru.json`:
```json
{
  "mode.name": "Командный бой",
  "mode.description": "Две команды сражаются, чтобы набрать лимит фрагов.",
  "Hint/AttackEnemies": "Атакуйте врагов",
  "GmParams/MapRotation": "Ротация карт"
}
```

Имена файлов задаются константами по схеме:
- Путь: `client/localization/{lang}.json`
- `{lang}` — первые 2 символа кода языка (I2) в нижнем регистре. Примеры: `ru-RU` → `ru`, `en-US` → `en`, `es-ES` → `es`.
- Примеры валидных имён: `ru.json`, `en.json`, `es.json`, `de.json`, `fr.json`.

### Использование ключей в скриптах

- Подсказки UI:
```javascript
Ui.GetContext().Hint.Value = "Hint/AttackEnemies"; // ключ локализации
```
- Попапы:
```javascript
player.PopUp("Hint/Welcome"); // ключ локализации или обычный текст
```
- Параметры в `gamemode.json` (ключи для отображаемых имен):
```json
{
  "Parameters": {
    "Bool": [
      { "Name": "MapRotation", "DisplayName": "GmParams/MapRotation", "Default": true }
    ]
  }
}
```

### Правила резолвинга переводов

Когда игра отображает строку по ключу:
1) Сначала ищется в локализации режима (`client/localization/{lang}.json`).
2) Затем — в глобальной локализации проекта.
3) Если нигде не найдено — отображается исходная строка.

Язык берётся из текущих настроек клиента. Если файла языка нет, применяется стандартный фолбэк (например: `ru-RU` → `ru` → `en`).

Ключи локализации чувствительны к регистру (case‑sensitive). В `gamemode.json` ключи в `Name`, `Description`, `MapLists[].Name`, `Parameters.*.DisplayName` сравниваются строго посимвольно.

Серверная часть (метаданные режимов) также использует ключи из этих словарей и применяет фолбэк в порядке: запрошенный язык → `en` → любой доступный язык → исходное значение.

### Проверка и отладка
- Убедитесь, что ключи в скриптах и в JSON совпадают посимвольно.
- Держите консистентные префиксы: `Hint/`, `GmParams/`, `mode.` и т.д.
- Избегайте дублирования ключей с разными значениями в разных языках.

### Советы по организации
- Старайтесь не вшивать пользовательские тексты напрямую в скрипты — лучше использовать ключи.
- Группируйте ключи по областям: `Hint/`, `Statistics/`, `GmParams/`, `mode.`
- Поддерживайте `en.json` как базовый набор на случай отсутствия переводов.

### Связанные разделы

- Формат `gamemode.json` и где можно использовать ключи: [gamemode_json.md](./gamemode_json.md)
